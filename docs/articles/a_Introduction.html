<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="beastr">
<title>1. Introduction • beastr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="1. Introduction">
<meta property="og:description" content="beastr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">beastr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/a_Introduction.html">1. Introduction</a>
    <a class="dropdown-item" href="../articles/b_QualityControl.html">2. Filtering Data</a>
    <a class="dropdown-item" href="../articles/c_Explore.html">3. Exploring the Data</a>
    <a class="dropdown-item" href="../articles/z_LearningR.html">Extra - Learning R</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rgzn/beastr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>1. Introduction</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rgzn/beastr/blob/HEAD/vignettes/a_Introduction.Rmd" class="external-link"><code>vignettes/a_Introduction.Rmd</code></a></small>
      <div class="d-none name"><code>a_Introduction.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rgzn.github.io/beastr/">beastr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://readr.tidyverse.org" class="external-link">readr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="getting-started">Getting Started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p><em>Help I have no idea what to do</em></p>
<p>This document goes over what data we need to assemble a database. It is likely that you have this data already, but it may not be in the correct formats. The goal here is to give the user an idea of a principled way to organize their data. Unfortunately, assembling, formatting, and organizing data are not steps that can be automated.</p>
<p>The example files here are all part of the package, so they live in subdirectories of:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># not evaluated because it illustrates a directory on author's machine:</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">""</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span></code></pre></div>
<p>And the directory structure therein represents one (of many) possibly ways to structure your data directories.</p>
<p>If you run this document from the .Rmd source, all the code sections like the above can be run on your computer. Some sections, like the above are specified not to automatically evaluate.</p>
<p>If you would like more information about RMarkdown, or just R in general, please see <a href="LearningR.html">the vignette on learning R</a>.</p>
</div>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p><em>Why would I bother?</em></p>
<p>Why does anyone need a database? What data goes in here? I will briefly try to answer those questions here.</p>
<p>Wildlife telemetry data is collected from placing devices in the field or directly on subject animals. These devices record data such as GPS fixes, activity logs, photos, etc.</p>
<p>We want to store and access not only information recorded by these devices, but information intrinsic to the devices (serial #, weight, etc) and the animals themselves (species, age, zodiac sign, etc). To maintain data validity, we can use separate tables to store each type of data, and then link those tables together for our analyses. This prevents us from having to do things like having to store all the information about Ricky the Weasel (eg. Favorite Food: Squirrel) on each of the twenty thousand records from the accelerometer on his collar.</p>
<p>The principle of storing each piece of information only once is called <em>atomicity</em> and is key in preventing data mismatches as records are added or changed.</p>
<p>For more motivation, please see the book that inspired this design: <em>Spatial Database for GPS Wildlife Tracking Data</em> <a href="">https://doi.org/10.1007/978-3-319-03743-1</a></p>
<p>And the basic principles of database theory: <a href="https://en.wikipedia.org/wiki/ACID" class="external-link">ACID</a></p>
<p>And lastly, while the database backend is admittedly tedious, it is essential for processing data, as in these guides:</p>
<ul>
<li>Telemetry Database Data Entry</li>
<li>Wildlife Telemetry Quality Control</li>
<li>Exploring Fisher Collar Data</li>
</ul>
</div>
<div class="section level2">
<h2 id="data-requirements">Data Requirements<a class="anchor" aria-label="anchor" href="#data-requirements"></a>
</h2>
<p><em>What am I even dealing with?</em></p>
<p>To build a new database, you will need to assemble the basic info as flat text files. This is the hardest part of the whole process, as it cannot be scripted.</p>
<p><strong>Telemetry Data:</strong></p>
<p>This guide deals with data from <a href="https://www.lotek.com/" class="external-link">Lotek</a> telemetry devices. The principles and architecture may be extended to other devices, but some new data parsing code will be required. This assumes you have data processed with Lotek software that can be saved in Lotek’s text file format.</p>
<p>These files are produced using Lotek’s proprietary software. They look like tab-delimitted text files, but there are some crucial differences. Let’s take a look at an example file:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Example Lotek Telemetry data:</span>
<span class="va">lotek_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"lotek/PinPoint33452.txt"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_lines.html" class="external-link">read_lines</a></span><span class="op">(</span><span class="va">lotek_file</span>, n_max <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt;  [1] "Index         Status  Sats  RTC-date  RTC-time  FIX-date      FIX-time   Delta(s)     Latitude    Longitude  Altitude(m)    HDOP        eRes  Temperature(C)  Voltage(V)"</span>
<span class="co">#&gt;  [2] "    1          Valid   4/4  21/11/23  21:38:46  21/11/23  21:38:47.183      1.183     37.67304   -119.64404      2191.00     2.1         0.2            11.5        3.85"</span>
<span class="co">#&gt;  [3] "    2          Valid   4/4  21/11/23  21:45:23  21/11/23  21:45:24.383      1.383     37.67314   -119.64399      2191.00     2.3         0.3             8.5        3.85"</span>
<span class="co">#&gt;  [4] "    3  NotEnoughSats   0/1  21/11/23  22:00:21                              1.000                                                                        5.5        3.80"</span>
<span class="co">#&gt;  [5] "    4  NotEnoughSats   0/2  21/11/23  22:11:51                              0.960                                                                       11.5        3.80"</span>
<span class="co">#&gt;  [6] "    5  NotEnoughSats   0/0  21/11/23  22:15:13                              0.950                                                                       13.5        3.80"</span>
<span class="co">#&gt;  [7] "    6  NotEnoughSats   0/0  21/11/23  22:35:13                              0.880                                                                       15.0        3.80"</span>
<span class="co">#&gt;  [8] "    7  NotEnoughSats   0/2  21/11/23  22:58:50                              0.810                                                                       23.5        3.80"</span>
<span class="co">#&gt;  [9] "    8  NotEnoughSats   0/1  21/11/23  23:00:22                              0.800                                                                       23.0        3.80"</span>
<span class="co">#&gt; [10] "    9  NotEnoughSats   0/1  21/11/23  23:15:15                              1.000                                                                       24.0        3.80"</span></code></pre></div>
<p>You may notice some small details that make this file slightly difficult. There are empty fields, but there is no dedicated delimiter to separate them. The date/time fields are not standard formats and no coordinate reference system is specified. Also there is crucial information (Device ID) only specified in the filename. If we want to use this data, import it to R with the <code><a href="../reference/read_lotek.html">read_lotek()</a></code> function:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">lotek_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/read_lotek.html">read_lotek</a></span><span class="op">(</span><span class="va">lotek_file</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lotek_data</span><span class="op">)</span>
<span class="co">#&gt; Simple feature collection with 6 features and 16 fields (with 4 geometries empty)</span>
<span class="co">#&gt; Geometry type: POINT</span>
<span class="co">#&gt; Dimension:     XY</span>
<span class="co">#&gt; Bounding box:  xmin: 266812.4 ymin: 4172829 xmax: 266817.1 ymax: 4172840</span>
<span class="co">#&gt; CRS:           EPSG:32611</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 17</span></span>
<span class="co">#&gt;   device_id Index Status       Sats  `RTC-date` `RTC-time` `FIX-date` `FIX-time`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;time&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;time&gt;</span>    </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 33452         1 Valid        4/4   21/11/23   21<span style="color: #949494;">:</span>38<span style="color: #949494;">:</span>46   21/11/23   21<span style="color: #949494;">:</span>38<span style="color: #949494;">:</span>47  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 33452         2 Valid        4/4   21/11/23   21<span style="color: #949494;">:</span>45<span style="color: #949494;">:</span>23   21/11/23   21<span style="color: #949494;">:</span>45<span style="color: #949494;">:</span>24  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 33452         3 NotEnoughSa… 0/1   21/11/23   22<span style="color: #949494;">:</span>00<span style="color: #949494;">:</span>21   <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 33452         4 NotEnoughSa… 0/2   21/11/23   22<span style="color: #949494;">:</span>11<span style="color: #949494;">:</span>51   <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 33452         5 NotEnoughSa… 0/0   21/11/23   22<span style="color: #949494;">:</span>15<span style="color: #949494;">:</span>13   <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 33452         6 NotEnoughSa… 0/0   21/11/23   22<span style="color: #949494;">:</span>35<span style="color: #949494;">:</span>13   <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 9 more variables: `Delta(s)` &lt;dbl&gt;, `Altitude(m)` &lt;dbl&gt;, HDOP &lt;dbl&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   eRes &lt;dbl&gt;, `Temperature(C)` &lt;dbl&gt;, `Voltage(V)` &lt;dbl&gt;, Ingest_Time &lt;dttm&gt;,</span></span>
<span class="co">#&gt; <span style="color: #949494;">#   geometry &lt;POINT [m]&gt;, time &lt;dttm&gt;</span></span></code></pre></div>
<p>Now we have tidy spatial data, and can do spatial manipulation with it.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">lotek_data</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Some Points from a Lotek Collar"</span><span class="op">)</span></code></pre></div>
<p><img src="a_Introduction_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>Telemetry devices may have other sensors as well. An example of this is “activity” data. These records are records from the on-board accelerometer aggregated into a measure called <a href="">Overall Dynamic Body Acceleration (ODBA)</a>. These records are recorded on a different schedule from the GPS fixes, so must be stored separately. Again, Lotek uses a file format that is <em>almost</em> a standard csv, but not quite, so we’ll need to use the function <code><a href="../reference/read_lotek_activity.html">read_lotek_activity()</a></code> from this package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Starts as 2 columns, switches to 3, doesn't parse:</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"lotek/activity33452.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_delim</a></span><span class="op">(</span>delim <span class="op">=</span> <span class="st">","</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span>, n_max <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>
<span class="co">#&gt; Warning: One or more parsing issues, see `problems()` for details</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 1</span></span>
<span class="co">#&gt;   `Product Type: Litetrack RF-40`</span>
<span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Product ID: 33452              </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Firmware Version: V8.107.0     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> GMT Time,ODBA,Temperature [C]  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 11/23/2021 9:40:00 PM,140,8.5  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 11/23/2021 9:45:00 PM,10,7.0   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 11/23/2021 9:50:00 PM,7,5.0</span>

<span class="co"># Using beastr:</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"lotek/activity33452.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="../reference/read_lotek_activity.html">read_lotek_activity</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4,321 × 4</span></span>
<span class="co">#&gt;    device_id time                 ODBA `Temperature [C]`</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 33452     2021-11-23 <span style="color: #949494;">21:40:00</span>   140               8.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 33452     2021-11-23 <span style="color: #949494;">21:45:00</span>    10               7  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 33452     2021-11-23 <span style="color: #949494;">21:50:00</span>     7               5  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 33452     2021-11-23 <span style="color: #949494;">21:55:00</span>    14               4.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 33452     2021-11-23 <span style="color: #949494;">22:00:00</span>     7               4  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 33452     2021-11-23 <span style="color: #949494;">22:05:00</span>     7               3.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 33452     2021-11-23 <span style="color: #949494;">22:10:00</span>    96               7.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 33452     2021-11-23 <span style="color: #949494;">22:15:00</span>   288              13  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 33452     2021-11-23 <span style="color: #949494;">22:20:00</span>   405              19.5</span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 33452     2021-11-23 <span style="color: #949494;">22:25:00</span>    28              14  </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 4,311 more rows</span></span></code></pre></div>
<p><em>{TODO}</em>: <em>Add support for more input file formats. This can be done as it becomes necessary with new devices. To preserve data, records with different fields for different types of devices should be stored in different tables. The crucial information is joined together into a single <code>VIEW</code> using the <code>deployments</code> table.</em></p>
<p><strong>Device Data:</strong></p>
<p>Beyond the data recorded by the telemetry devices, we also want to store information about the devices themselves. This includes things like the serial number, manufacturer, attachment type, etc. This is data tied to a device that does not vary between the individual samples recorded by the device.</p>
<p>This data does not automatically come from the device, so it needs to be manually assembled into one or more CSV/spreadsheets.</p>
<p>Here’s what an example looks like:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">device_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"devices/collars.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">device_file</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">33</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">7</span><span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (5): Type, Make, Model, Antenna, Notes</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (2): ID, VHF</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 7</span></span>
<span class="co">#&gt;       ID Type   Make    Model Antenna    VHF Notes</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span>
<span class="co">#&gt; <span style="color: #BCBCBC;">1</span>  <span style="text-decoration: underline;">33</span>465 collar Lotek   LT40  Internal  169. <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">33</span>448 collar Lotek   LT40  Internal  168. <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="text-decoration: underline;">259</span>181 collar Holohil MI-2M <span style="color: #BB0000;">NA</span>        169. <span style="color: #BB0000;">NA</span>   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="text-decoration: underline;">259</span>182 collar Holohil MI-2M <span style="color: #BB0000;">NA</span>        169. <span style="color: #BB0000;">NA</span></span></code></pre></div>
<p>In this case, we only have one list of devices. But if there were others that we wanted to combine, we could search for them using <code>fs</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Find all CSVs in the device directory:</span>
<span class="va">device_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"devices"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fs/man/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">device_dir</span>, regexp <span class="op">=</span> <span class="st">"*.csv"</span>, recurse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; /Library/Frameworks/R.framework/Versions/4.1/Resources/library/beastr/devices/collars.csv</span></code></pre></div>
<p><strong>Animal Data:</strong></p>
<p>The whole reason we are doing this is to learn about animals. We need to store information about them! A lot of what we know about the animals does not come from a telemetry device, we need to compile it here.</p>
<p>Again, this will be one ormore flat CSV/spreadsheets.</p>
<p>Here’s what an example looks like, this time we’re reading multiple files in:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">animal_dir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"animals"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="va">animal_files</span> <span class="op">=</span> <span class="fu">fs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fs/man/dir_ls.html" class="external-link">dir_ls</a></span><span class="op">(</span><span class="va">animal_dir</span>, regexp <span class="op">=</span> <span class="st">"*.csv"</span>, recurse <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">animal_files</span><span class="op">)</span> 
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">18</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">5</span><span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span> (5): ID, AgeClass, GeneralArea, Sex, Species</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 18 × 5</span></span>
<span class="co">#&gt;    ID    AgeClass GeneralArea      Sex   Species</span>
<span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> MF01  Adult    Elevenmile       F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> MF02  Subadult GPR              F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> MF03  Subadult GPR              F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> MF04  Adult    Moss/ Hodgdon    F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> MF04  Adult    Moss/ Hodgdon    F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> MF05  Adult    Moss/Hazel Green F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> MF06  Subadult Valley           F     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> MM01  Adult    Moss/Merced      M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> MM02  Juvenile Summit           M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span> MM03  Juvenile Summit           M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span> MM04  Juvenile Summit           M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span> MM05  Adult    South Gate       M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">13</span> MM06  Adult    Moss/Tuolumne    M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">14</span> MM07  Subadult GPR              M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">15</span> MM08  Adult    Elevenmile       M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">16</span> MM09  Adult    Moss             M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">17</span> MM10  Juvenile South Gate       M     PEPE   </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">18</span> MM11  Adult    GPR              M     PEPE</span></code></pre></div>
<p><strong>Deployment Data:</strong> Animal telemetry devices are deployed on animals, but some animals may have multiple devices, and devices often record data even when they are not deployed. In order to properly tie the various recorded data to their animals, we need to store deployment info. The key fields of this data are: <em>device_id</em>, <em>animal_id</em>, <em>in_service</em>, <em>out_service</em>. There are more fields, but those are the key to understanding the purpose of this data.</p>
<p>Again, this will be one or more flat CSV/spreadsheets.</p>
<p>Example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">deploy_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"deployments/deployments.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">deploy_file</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span><span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (3): AnimalID, Start_Method, Stop_Method</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span>  (1): DeviceID</span>
<span class="co">#&gt; <span style="color: #0000BB;">dttm</span> (2): In_Service, Out_Service</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 6</span></span>
<span class="co">#&gt;    DeviceID AnimalID In_Service          Out_Service         Start_Method</span>
<span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dttm&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    <span style="text-decoration: underline;">33</span>468 MM02     2021-10-17 <span style="color: #949494;">15:35:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    <span style="text-decoration: underline;">33</span>467 MM03     2021-10-18 <span style="color: #949494;">16:19:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    <span style="text-decoration: underline;">33</span>454 MM04     2021-10-19 <span style="color: #949494;">15:46:00</span> 2022-01-13 <span style="color: #949494;">13:08:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    <span style="text-decoration: underline;">33</span>508 MM05     2021-10-31 <span style="color: #949494;">13:32:00</span> 2022-02-09 <span style="color: #949494;">12:55:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    <span style="text-decoration: underline;">33</span>456 MF01     2021-11-19 <span style="color: #949494;">14:03:50</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    <span style="text-decoration: underline;">33</span>452 MF02     2021-11-23 <span style="color: #949494;">14:53:00</span> 2021-12-08 <span style="color: #949494;">13:35:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    <span style="text-decoration: underline;">33</span>459 MF03     2021-11-24 <span style="color: #949494;">14:31:00</span> 2022-02-12 <span style="color: #949494;">14:45:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    <span style="text-decoration: underline;">33</span>469 MM07     2021-11-24 <span style="color: #949494;">18:33:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    <span style="text-decoration: underline;">33</span>507 MM08     2021-11-24 <span style="color: #949494;">18:18:00</span> 2022-03-05 <span style="color: #949494;">13:26:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    <span style="text-decoration: underline;">33</span>506 MM09     2022-01-22 <span style="color: #949494;">13:41:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    <span style="text-decoration: underline;">33</span>465 MF04     2022-01-13 <span style="color: #949494;">15:15:00</span> 2022-02-14 <span style="color: #949494;">12:24:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    <span style="text-decoration: underline;">33</span>448 MF05     2022-01-15 <span style="color: #949494;">14:38:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    <span style="text-decoration: underline;">33</span>512 MM06     2021-10-31 <span style="color: #949494;">15:35:00</span> 2022-01-16 <span style="color: #949494;">13:52:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">14</span>    <span style="text-decoration: underline;">33</span>510 MM06     2022-01-16 <span style="color: #949494;">15:01:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">15</span>    <span style="text-decoration: underline;">33</span>463 MF06     2022-01-27 <span style="color: #949494;">13:47:00</span> 2022-02-19 <span style="color: #949494;">15:30:00</span> capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">16</span>    <span style="text-decoration: underline;">33</span>504 MM05     2022-02-09 <span style="color: #949494;">13:31:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">17</span>    <span style="text-decoration: underline;">33</span>982 MM04     2022-02-14 <span style="color: #949494;">13:57:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">18</span>   <span style="text-decoration: underline;">259</span>186 MF04     2022-03-02 <span style="color: #949494;">13:08:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">19</span>    <span style="text-decoration: underline;">33</span>983 MM08     2022-03-05 <span style="color: #949494;">14:16:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #BCBCBC;">20</span>    <span style="text-decoration: underline;">33</span>984 MM11     2022-03-07 <span style="color: #949494;">13:28:00</span> <span style="color: #BB0000;">NA</span>                  capture     </span>
<span class="co">#&gt; <span style="color: #949494;"># … with 1 more variable: Stop_Method &lt;chr&gt;</span></span></code></pre></div>
<p><em>{TODO}</em>: <em>Need to add a non-animal deployment table for environmental and ambient devices. This should be a spatial table.</em></p>
<p><em>Some telemetry devices may record environmental data (such as weather stations) or ambient data (like Acoustic Recording Units), and are not tied to a specific animal. [NOT YET IMPLEMENTED]</em></p>
</div>
<div class="section level2">
<h2 id="building-a-geopackage">Building a Geopackage<a class="anchor" aria-label="anchor" href="#building-a-geopackage"></a>
</h2>
<p>Now that you understand the raw data formats, we can run the script in the README:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Use example source data</span>
<span class="va">fix_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"lotek/PinPoint33452.txt"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="va">device_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"devices/collars.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="va">animal_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"animals/critters.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="va">deploy_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"deployments/deployments.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>
<span class="va">activity_file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"lotek/activity33452.csv"</span>, package <span class="op">=</span> <span class="st">"beastr"</span><span class="op">)</span>

<span class="co"># Create a path to a geopackage in a temporary directory:</span>
<span class="va">myDB</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span>check <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"/"</span>, <span class="st">"example.gpkg"</span><span class="op">)</span>

<span class="co"># Build a database</span>
<span class="fu"><a href="../reference/build_database.html">build_database</a></span><span class="op">(</span>fix_files <span class="op">=</span> <span class="va">fix_file</span>,
               device_files <span class="op">=</span> <span class="va">device_file</span>,
               animal_files <span class="op">=</span> <span class="va">animal_file</span>,
               deployment_files <span class="op">=</span> <span class="va">deploy_file</span>,
               dsn <span class="op">=</span> <span class="va">myDB</span>,
               tz <span class="op">=</span> <span class="st">"US/Pacific"</span><span class="op">)</span>
<span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">20</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">6</span><span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────</span></span>
<span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span>
<span class="co">#&gt; <span style="color: #BB0000;">chr</span>  (3): AnimalID, Start_Method, Stop_Method</span>
<span class="co">#&gt; <span style="color: #00BB00;">dbl</span>  (1): DeviceID</span>
<span class="co">#&gt; <span style="color: #0000BB;">dttm</span> (2): In_Service, Out_Service</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Use `spec()` to retrieve the full column specification for this data.</span>
<span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span>
<span class="co">#&gt; Warning in clean_columns(as.data.frame(obj), factorsAsCharacter): Dropping</span>
<span class="co">#&gt; column(s) RTC-time,FIX-time of class(es) hms;difftime,hms;difftime</span>
<span class="co">#&gt; Warning: Missing values are always removed in SQL.</span>
<span class="co">#&gt; Use `MIN(x, na.rm = TRUE)` to silence this warning</span>
<span class="co">#&gt; This warning is displayed only once per session.</span>
<span class="co">#&gt; Warning: Missing values are always removed in SQL.</span>
<span class="co">#&gt; Use `MAX(x, na.rm = TRUE)` to silence this warning</span>
<span class="co">#&gt; This warning is displayed only once per session.</span>

<span class="co"># What layers are in there?</span>
<span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_layers.html" class="external-link">st_layers</a></span><span class="op">(</span><span class="va">myDB</span><span class="op">)</span>
<span class="co">#&gt; Driver: GPKG </span>
<span class="co">#&gt; Available layers:</span>
<span class="co">#&gt;     layer_name geometry_type features fields crs_name</span>
<span class="co">#&gt; 1        fixes         Point      468     14    32611</span>
<span class="co">#&gt; 2 animal_fixes         Point      462     12    32611</span>
<span class="co">#&gt; 3      devices            NA       33      7     &lt;NA&gt;</span>
<span class="co">#&gt; 4      animals            NA        4      5     &lt;NA&gt;</span>
<span class="co">#&gt; 5  deployments            NA       20      6     &lt;NA&gt;</span></code></pre></div>
<p>You may notice I forgot to import the activity files. Let’s do that now, as an example of adding an extra layer to an existing database:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">activity_data</span> <span class="op">=</span> <span class="fu"><a href="../reference/read_lotek_activity.html">read_lotek_activity</a></span><span class="op">(</span><span class="va">activity_file</span><span class="op">)</span>
<span class="fu"><a href="../reference/append_layer.html">append_layer</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">activity_data</span>,
             dsn <span class="op">=</span> <span class="va">myDB</span>,
             layer <span class="op">=</span> <span class="st">"activity"</span><span class="op">)</span>
<span class="co">#&gt; Updating layer `activity' to data source `/var/folders/q2/53ffh3110_5fqqp7tmq2s5th0000gn/T//Rtmp8DSEiu/example.gpkg' using driver `GPKG'</span>
<span class="co">#&gt; Writing 4321 features with 4 fields without geometries.</span>

<span class="co"># a new layer:</span>
<span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_layers.html" class="external-link">st_layers</a></span><span class="op">(</span><span class="va">myDB</span><span class="op">)</span>
<span class="co">#&gt; Driver: GPKG </span>
<span class="co">#&gt; Available layers:</span>
<span class="co">#&gt;     layer_name geometry_type features fields crs_name</span>
<span class="co">#&gt; 1        fixes         Point      468     14    32611</span>
<span class="co">#&gt; 2 animal_fixes         Point      462     12    32611</span>
<span class="co">#&gt; 3      devices            NA       33      7     &lt;NA&gt;</span>
<span class="co">#&gt; 4      animals            NA        4      5     &lt;NA&gt;</span>
<span class="co">#&gt; 5  deployments            NA       20      6     &lt;NA&gt;</span>
<span class="co">#&gt; 6     activity            NA     4321      4     &lt;NA&gt;</span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jon Weissman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
